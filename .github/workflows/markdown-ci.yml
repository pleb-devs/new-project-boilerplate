name: Markdown CI

on:
  push:
    branches:
      - main
    paths:
      - "**/*.md"
      - ".github/workflows/markdown-ci.yml"
      - ".markdownlint.jsonc"
  pull_request:
    paths:
      - "**/*.md"
      - ".github/workflows/markdown-ci.yml"
      - ".markdownlint.jsonc"
  workflow_dispatch:

permissions:
  contents: read

jobs:
  markdownlint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Markdown lint
        uses: DavidAnson/markdownlint-cli2-action@v22
        with:
          config: .markdownlint.jsonc
          globs: "**/*.md"

  link-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Link check (lychee)
        uses: lycheeverse/lychee-action@v2
        with:
          fail: false
          args: >-
            --verbose
            --no-progress
            --cache
            --max-cache-age 1d
            --accept 200,204,429
            "./**/*.md"
